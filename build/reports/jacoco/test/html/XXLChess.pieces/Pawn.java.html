<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Pawn.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">chessXXL</a> &gt; <a href="index.source.html" class="el_package">XXLChess.pieces</a> &gt; <span class="el_source">Pawn.java</span></div><h1>Pawn.java</h1><pre class="source lang-java linenums">package XXLChess.pieces;

import java.util.ArrayList;
import java.util.List;

import XXLChess.App;
import XXLChess.Pieceset;
import XXLChess.Tileset;
import XXLChess.board.logic.Move;
import XXLChess.enums.Colour;
import processing.core.PApplet;

public class Pawn extends ChessPiece {
<span class="nc" id="L14">    private String keyB = &quot;P&quot;;</span>
<span class="nc" id="L15">    private String keyW = &quot;p&quot;;</span>

    public Pawn(PApplet parent, int x, int y, Colour colour, int row, int col) {
<span class="nc" id="L18">        super(parent, x, y, colour, row, col);</span>
<span class="nc" id="L19">        this.x = x;</span>
<span class="nc" id="L20">        this.y = y;</span>
<span class="nc" id="L21">        this.row = row;</span>
<span class="nc" id="L22">        this.col = col;</span>
<span class="nc" id="L23">    }</span>

    @Override
    public String toString() {
<span class="nc bnc" id="L27" title="All 2 branches missed.">        if (colour == Colour.BLACK) {</span>
<span class="nc" id="L28">            return keyB;</span>
        } else {
<span class="nc" id="L30">            return keyW;</span>
        }
    }

    @Override
    public void loadImage() {
<span class="nc bnc" id="L36" title="All 2 branches missed.">        if (this.colour == Colour.BLACK) {</span>
            try {
<span class="nc" id="L38">                image = parent.loadImage(App.PATH + &quot;b-pawn.png&quot;);</span>
<span class="nc" id="L39">            } catch (RuntimeException e) {</span>
<span class="nc" id="L40">                e.printStackTrace();</span>
<span class="nc" id="L41">            }</span>
<span class="nc bnc" id="L42" title="All 2 branches missed.">        } else if (this.colour == Colour.WHITE) {</span>
            try {
<span class="nc" id="L44">                image = parent.loadImage(App.PATH + &quot;w-pawn.png&quot;);</span>
<span class="nc" id="L45">            } catch (RuntimeException e) {</span>
<span class="nc" id="L46">                e.printStackTrace();</span>
<span class="nc" id="L47">            }</span>
        }
<span class="nc" id="L49">    } </span>

    @Override
    public String getKey() {
<span class="nc" id="L53">        return this.key;</span>
    }

    @Override
    public int getRow() {
<span class="nc" id="L58">        return this.row;</span>
    }

    @Override 
    public int getCol() {
<span class="nc" id="L63">        return this.col;</span>
    }

    @Override
    public int getX() {
<span class="nc" id="L68">        return this.x;</span>
    }

    @Override
    public int getY() {
<span class="nc" id="L73">        return this.y;</span>
    }

    @Override
    public void setX(int x) {
<span class="nc" id="L78">        this.x = x;</span>
<span class="nc" id="L79">    }</span>

    @Override
    public void setY(int y) {
<span class="nc" id="L83">        this.y = y;</span>
<span class="nc" id="L84">    }</span>

    @Override
    public List&lt;Move&gt; getValidMoves(Tileset tiles, Pieceset pieces) {
<span class="nc" id="L88">        List&lt;Move&gt; validMoves = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L89">        int currentRow = this.row, currentCol = this.col, boardDir = 1;</span>

<span class="nc bnc" id="L91" title="All 2 branches missed.">        if (direction == &quot;Up&quot;) {</span>
<span class="nc" id="L92">            boardDir = -1;</span>
        }

        // check forward square
<span class="nc" id="L96">        int forwardRow = currentRow + (1 * boardDir);</span>
<span class="nc bnc" id="L97" title="All 6 branches missed.">        if ((forwardRow &lt; App.BOARD_WIDTH) &amp; (forwardRow &gt; 0)) {</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">            if (tiles.getTile(forwardRow, currentCol).getOccupied() == false) {</span>
<span class="nc" id="L99">                validMoves.add(new Move(forwardRow, currentCol));  </span>
                
                // if forward row is unblocked, than can check if next forward row is available.
<span class="nc bnc" id="L102" title="All 2 branches missed.">                if (firstMove) {</span>
<span class="nc" id="L103">                    int doubleforwardRow = currentRow + (2 * boardDir);</span>
<span class="nc bnc" id="L104" title="All 2 branches missed.">                    if ((doubleforwardRow &lt; App.BOARD_WIDTH) </span>
<span class="nc bnc" id="L105" title="All 4 branches missed.">                        &amp; (tiles.getTile(doubleforwardRow, currentCol).getOccupied() == false)) {</span>
<span class="nc" id="L106">                            validMoves.add(new Move(doubleforwardRow, currentCol));</span>
                    }
                }
            }
        }

        // check if capture available
<span class="nc" id="L113">        int[] captureCol = {currentCol - 1, currentCol + 1};</span>
<span class="nc bnc" id="L114" title="All 2 branches missed.">        if (captureCol[0] &gt;= 0) {</span>
<span class="nc bnc" id="L115" title="All 2 branches missed.">            if (tiles.getTile(forwardRow, captureCol[0]).getOccupied()) {</span>
<span class="nc" id="L116">                ChessPiece capturedPiece = pieces.getPiece(forwardRow, captureCol[0]);</span>
<span class="nc" id="L117">                validMoves.add(new Move(forwardRow, captureCol[0], capturedPiece));</span>
            }
        }
        
<span class="nc bnc" id="L121" title="All 2 branches missed.">        if (captureCol[1] &lt; App.BOARD_WIDTH) {</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">            if (tiles.getTile(forwardRow, captureCol[1]).getOccupied()) {</span>
<span class="nc" id="L123">                ChessPiece capturedPiece = pieces.getPiece(forwardRow, captureCol[1]);</span>
<span class="nc" id="L124">                validMoves.add(new Move(forwardRow, captureCol[1], capturedPiece));</span>
            }
        }

        // TODO: Add special moves for pawn, changing to queen at end of board?
        
<span class="nc" id="L130">        return validMoves;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>